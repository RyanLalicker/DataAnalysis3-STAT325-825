custom_names <- c("Calving Ease", "Calf Vigor", "Final Calf Weight")
calc_stats <- function(var) {
mean_val <- mean(var, na.rm = TRUE)
median_val <- median(var, na.rm = TRUE)
sd_val <- sd(var, na.rm = TRUE)
quantiles <- quantile(var, probs = c(0.25, 0.75), na.rm = TRUE)
c(mean = mean_val, median = median_val, sd = sd_val, Q1 = quantiles[1], Q3 = quantiles[2])
}
# Apply the function to each variable in dep_vars and create a summary table
summary_table <- t(sapply(dep_vars, function(var) calc_stats(data[[var]])))
# Convert to data frame and assign variable names
summary_table <- as.data.frame(summary_table)
summary_table$Variable <- dep_vars
# Reorder columns to make the variable name first
summary_table <- summary_table[, c("Variable", "mean", "median", "sd", "Q1", "Q3")]
#| label: fig-summarystats
#| echo: false
#| eval: true
dep_vars <- c("Calving.Ease", "Calf.Vigor", "Final.Calf.BW")
custom_names <- c("Calving Ease", "Calf Vigor", "Final Calf Weight")
calc_stats <- function(var) {
mean_val <- mean(var, na.rm = TRUE)
median_val <- median(var, na.rm = TRUE)
sd_val <- sd(var, na.rm = TRUE)
quantiles <- quantile(var, probs = c(0.25, 0.75), na.rm = TRUE)
c(mean = mean_val, median = median_val, sd = sd_val, Q1 = quantiles[1], Q3 = quantiles[2])
}
summary_table <- t(sapply(dep_vars, function(var) calc_stats(data[[var]])))
summary_table <- as.data.frame(summary_table)
summary_table$Variable <- rownames(summary_table)
rownames(summary_table) <- NULL
# Print the table with knitr::kable
kable(summary_table, col.names = c("Mean", "Median", "SD", "25th Percentile", "75th Percentile", "Variable"),
caption = "Summary Statistics for Dependent Variables")
summary_table$Variable <- rownames(custom_names)
#| label: fig-summarystats
#| echo: false
#| eval: true
dep_vars <- c("Calving.Ease", "Calf.Vigor", "Final.Calf.BW")
custom_names <- c("Calving Ease", "Calf Vigor", "Final Calf Weight")
calc_stats <- function(var) {
mean_val <- mean(var, na.rm = TRUE)
median_val <- median(var, na.rm = TRUE)
sd_val <- sd(var, na.rm = TRUE)
quantiles <- quantile(var, probs = c(0.25, 0.75), na.rm = TRUE)
c(mean = mean_val, median = median_val, sd = sd_val, Q1 = quantiles[1], Q3 = quantiles[2])
}
summary_table <- t(sapply(dep_vars, function(var) calc_stats(data[[var]])))
summary_table <- as.data.frame(summary_table)
summary_table$Variable <- rownames(custom_names)
rownames(summary_table) <- NULL
# Print the table with knitr::kable
kable(summary_table, col.names = c("Mean", "Median", "SD", "25th Percentile", "75th Percentile", "Variable"),
caption = "Summary Statistics for Dependent Variables")
summary_table$Variable
summary_table$Variable <- rownames(summary_table)
summary_table$Variable
rownames(summary_table) <- NULL
summary_table <- as.data.frame(summary_table)
summary_table <- t(sapply(dep_vars, function(var) calc_stats(data[[var]])))
summary_table <- as.data.frame(summary_table)
kable(summary_table, col.names = c("Mean", "Median", "SD", "25th Percentile", "75th Percentile", "Variable"),
caption = "Summary Statistics for Dependent Variables")
#| label: fig-summarystats
#| echo: false
#| eval: true
dep_vars <- c("Calving.Ease", "Calf.Vigor", "Final.Calf.BW")
custom_names <- c("Calving Ease", "Calf Vigor", "Final Calf Weight")
calc_stats <- function(var) {
mean_val <- mean(var, na.rm = TRUE)
median_val <- median(var, na.rm = TRUE)
sd_val <- sd(var, na.rm = TRUE)
quantiles <- quantile(var, probs = c(0.25, 0.75), na.rm = TRUE)
c(mean = mean_val, median = median_val, sd = sd_val, Q1 = quantiles[1], Q3 = quantiles[2])
}
summary_table <- t(sapply(dep_vars, function(var) calc_stats(data[[var]])))
summary_table <- as.data.frame(summary_table)
kable(summary_table, col.names = c("Variable", "Mean", "Median", "SD", "25th Percentile", "75th Percentile"),
caption = "Summary Statistics for Dependent Variables")
#| label: fig-summarystats
#| echo: false
#| eval: true
dep_vars <- c("Calving.Ease", "Calf.Vigor", "Final.Calf.BW")
custom_names <- c("Calving Ease", "Calf Vigor", "Final Calf Weight")
calc_stats <- function(var) {
mean_val <- mean(var, na.rm = TRUE)
median_val <- median(var, na.rm = TRUE)
sd_val <- sd(var, na.rm = TRUE)
quantiles <- quantile(var, probs = c(0.25, 0.75), na.rm = TRUE)
max <- max(var, na.rm = TRUE)
min <- min(var, na.rm = TRUE)
c(mean = mean_val, median = median_val, sd = sd_val, Q1 = quantiles[1], Q3 = quantiles[2], Min = min, Max = max)
}
summary_table <- t(sapply(dep_vars, function(var) calc_stats(data[[var]])))
summary_table <- as.data.frame(summary_table)
kable(summary_table, col.names = c("Variable", "Mean", "Median", "SD", "25th Percentile", "75th Percentile"),
caption = "Summary Statistics for Dependent Variables")
summary_table <- t(sapply(dep_vars, function(var) calc_stats(data[[var]])))
summary_table <- as.data.frame(summary_table)
kable(summary_table, col.names = c("Variable", "Mean", "Median", "SD", "25th Percentile", "75th Percentile"),
caption = "Summary Statistics for Dependent Variables")
#| label: fig-summarystats
#| echo: false
#| eval: true
dep_vars <- c("Calving.Ease", "Calf.Vigor", "Final.Calf.BW")
custom_names <- c("Calving Ease", "Calf Vigor", "Final Calf Weight")
calc_stats <- function(var) {
mean_val <- mean(var, na.rm = TRUE)
median_val <- median(var, na.rm = TRUE)
sd_val <- sd(var, na.rm = TRUE)
quantiles <- quantile(var, probs = c(0.25, 0.75), na.rm = TRUE)
max <- max(var, na.rm = TRUE)
min <- min(var, na.rm = TRUE)
c(mean = mean_val, median = median_val, sd = sd_val, Q1 = quantiles[1], Q3 = quantiles[2], Min = min, Max = max)
}
summary_table <- t(sapply(dep_vars, function(var) calc_stats(data[[var]])))
summary_table <- as.data.frame(summary_table)
kable(summary_table, col.names = c("Variable", "Mean", "Median", "SD", "25th Percentile", "75th Percentile", "Min", "Max"),
caption = "Summary Statistics for Dependent Variables")
#| label: fig-summarystats
#| echo: false
#| eval: true
dep_vars <- c("Calving.Ease", "Calf.Vigor", "Final.Calf.BW")
custom_names <- c("Calving Ease", "Calf Vigor", "Final Calf Weight")
calc_stats <- function(var) {
mean_val <- mean(var, na.rm = TRUE)
median_val <- median(var, na.rm = TRUE)
sd_val <- sd(var, na.rm = TRUE)
quantiles <- quantile(var, probs = c(0.25, 0.75), na.rm = TRUE)
max <- max(var, na.rm = TRUE)
min <- min(var, na.rm = TRUE)
c(mean = mean_val, median = median_val, sd = sd_val, Q1 = quantiles[1], Q3 = quantiles[2], Min = min, Max = max)
}
summary_table <- t(sapply(dep_vars, function(var) calc_stats(data[[var]])))
summary_table <- as.data.frame(summary_table)
kable(summary_table, col.names = c("Variable", "Mean", "Median", "SD", "25th Percentile", "75th Percentile", "Min", "Max"),
caption = "Summary Statistics for Dependent Variables")
#| label: fig-normality
#| echo: false
#| eval: true
#| fig-cap: "Plots used to check if the distribution of the final calf weight is normal."
#| fig-subcap:
#|  - "Histogram of final calf weight."
#|  - "Q-Q plot of final calf weight."
#| fig-width: 6
#| fig-height: 4
ggplot(data, aes(x = Final.Calf.BW)) +
geom_histogram(binwidth = 0.5, color = "black", fill = "skyblue") +
labs(
x = "Starch Content",
y = "Frequency"
) +
theme_minimal()
ggplot(data, aes(sample = Final.Calf.BW)) +
stat_qq() +
stat_qq_line(color = "red") +
labs(
x = "Theoretical Quantiles",
y = "Sample Quantiles"
) +
theme_minimal()
#| label: fig-normality
#| echo: false
#| eval: true
#| fig-cap: "Plots used to check if the distribution of the final calf weight is normal."
#| fig-subcap:
#|  - "Histogram of final calf weight."
#|  - "Q-Q plot of final calf weight."
#| fig-width: 6
#| fig-height: 4
ggplot(data, aes(x = Final.Calf.BW)) +
geom_histogram(binwidth = 0.5, color = "black", fill = "skyblue") +
labs(
x = "Starch Content",
y = "Frequency"
) +
theme_minimal()
ggplot(data, aes(sample = Final.Calf.BW)) +
stat_qq() +
stat_qq_line(color = "red") +
labs(
x = "Theoretical Quantiles",
y = "Sample Quantiles"
) +
theme_minimal()
#| label: fig-normality
#| echo: false
#| eval: true
#| fig-cap: "Plots used to check if the distribution of the final calf weight is normal."
#| fig-subcap:
#|  - "Histogram of final calf weight."
#|  - "Q-Q plot of final calf weight."
#| fig-width: 6
#| fig-height: 4
ggplot(data, aes(x = Final.Calf.BW)) +
geom_histogram(binwidth = 10, color = "black", fill = "skyblue") +
labs(
x = "Starch Content",
y = "Frequency"
) +
theme_minimal()
ggplot(data, aes(sample = Final.Calf.BW)) +
stat_qq() +
stat_qq_line(color = "red") +
labs(
x = "Theoretical Quantiles",
y = "Sample Quantiles"
) +
theme_minimal()
#| label: fig-normality
#| echo: false
#| eval: true
#| fig-cap: "Plots used to check if the distribution of the final calf weight is normal."
#| fig-subcap:
#|  - "Histogram of final calf weight."
#|  - "Q-Q plot of final calf weight."
#| fig-width: 6
#| fig-height: 4
ggplot(data, aes(x = Final.Calf.BW)) +
geom_histogram(binwidth = 20, color = "black", fill = "skyblue") +
labs(
x = "Starch Content",
y = "Frequency"
) +
theme_minimal()
ggplot(data, aes(sample = Final.Calf.BW)) +
stat_qq() +
stat_qq_line(color = "red") +
labs(
x = "Theoretical Quantiles",
y = "Sample Quantiles"
) +
theme_minimal()
bin_width <- 2*IQR(data$Final.Calf.BW)/(n(data$Final.Calf.BW))^(1/3)
IQR(data$Final.Calf.BW)
n(data$Final.Calf.BW)
length(data$Final.Calf.BW
length(data$Final.Calf.BW)
length(data$Final.Calf.BW)
bin_width <- 2*IQR(data$Final.Calf.BW)/(length(data$Final.Calf.BW))^(1/3)
bin_width <- round(2*IQR(data$Final.Calf.BW)/(length(data$Final.Calf.BW))^(1/3), 2)
#| label: fig-normality
#| echo: false
#| eval: true
#| fig-cap: "Plots used to check if the distribution of the final calf weight is normal."
#| fig-subcap:
#|  - "Histogram of final calf weight."
#|  - "Q-Q plot of final calf weight."
#| fig-width: 6
#| fig-height: 4
bin_width <- round(2*IQR(data$Final.Calf.BW)/(length(data$Final.Calf.BW))^(1/3), 2)
ggplot(data, aes(x = Final.Calf.BW)) +
geom_histogram(binwidth = bin_width, color = "black", fill = "skyblue") +
labs(
x = "Starch Content",
y = "Frequency"
) +
theme_minimal()
ggplot(data, aes(sample = Final.Calf.BW)) +
stat_qq() +
stat_qq_line(color = "red") +
labs(
x = "Theoretical Quantiles",
y = "Sample Quantiles"
) +
theme_minimal()
#| label: fig-normality
#| echo: false
#| eval: true
#| fig-cap: "Histograms of scoring variables."
#| layout-ncol: 2
#| fig-subcap:
#|  - "Histogram of calving ease."
#|  - "Histogram of calf vigor."
#| fig-width: 6
#| fig-height: 4
ggplot(data, aes(x = Calving.Ease)) +
geom_histogram(binwidth = bin_width, color = "black", fill = "skyblue") +
labs(
x = "Starch Content",
y = "Frequency"
) +
theme_minimal()
bin_width <- round(2*IQR(data$Calving.Ease)/(length(data$Calving.Ease))^(1/3), 2)
#| label: fig-normality
#| echo: false
#| eval: true
#| fig-cap: "Histograms of scoring variables."
#| layout-ncol: 2
#| fig-subcap:
#|  - "Histogram of calving ease."
#|  - "Histogram of calf vigor."
#| fig-width: 6
#| fig-height: 4
ggplot(data, aes(x = Calving.Ease)) +
geom_histogram(binwidth = 1, color = "black", fill = "skyblue") +
labs(
x = "Starch Content",
y = "Frequency"
) +
theme_minimal()
#| label: fig-normality
#| echo: false
#| eval: true
#| fig-cap: "Histograms of scoring variables."
#| layout-ncol: 2
#| fig-subcap:
#|  - "Histogram of calving ease."
#|  - "Histogram of calf vigor."
#| fig-width: 6
#| fig-height: 4
ggplot(data, aes(x = Calving.Ease)) +
geom_histogram(binwidth = 1, color = "black", fill = "skyblue") +
labs(
x = "Starch Content",
y = "Frequency"
) +
theme_minimal()
ggplot(data, aes(x = Calf.Vigor)) +
geom_histogram(binwidth = 1, color = "black", fill = "skyblue") +
labs(
x = "Starch Content",
y = "Frequency"
) +
theme_minimal()
#| label: data-setup
#| echo: false
#| eval: true
library(knitr)
library(dplyr)
library(ggplot2)
library(naniar)
library(reshape2)
library(GGally)
library(janitor)
library(emmeans)
library(MASS)
library(multcomp)
library(lme4)
library(nnet)
data <- read.csv("data.csv")
# Placeholder of original data
origdata <- data
data <- data %>%
mutate(across(everything(), ~ ifelse(. %in% c(".", ""), NA, .)))
#| label: quant-imputing
#| echo: false
#| eval: true
#colnames(data)
quant <- c("Pen..", "Initial.BW",
"Final.BW", "DMI", "ADG",
"Gest.Length", "X1st.Calf.BW",
"Calving.Ease", "Calf.Vigor", "Final.Calf.BW",
"HCW", "REA", "YG", "BF")
for (var in quant) {
data[[var]] <- as.numeric(data[[var]])
data[[var]][is.na(data[[var]])] <- median(data[[var]], na.rm = TRUE)
}
for (var in names(df)) {
if (!(var %in% quant_vars)) {
df[[var]] <- as.character(df[[var]])
}
}
#| label: cat-cutting
#| echo: false
#| eval: true
#colnames(data)
cat_used <- c("Calan.Treatment", "SEX")
cleaned_data <- data[complete.cases(data[, cat_used]), ]
#| label: fig-summary-stats
#| echo: false
#| eval: true
dep_vars <- c("Calving.Ease", "Calf.Vigor", "Final.Calf.BW")
custom_names <- c("Calving Ease", "Calf Vigor", "Final Calf Weight")
calc_stats <- function(var) {
mean_val <- mean(var, na.rm = TRUE)
median_val <- median(var, na.rm = TRUE)
sd_val <- sd(var, na.rm = TRUE)
quantiles <- quantile(var, probs = c(0.25, 0.75), na.rm = TRUE)
max <- max(var, na.rm = TRUE)
min <- min(var, na.rm = TRUE)
c(mean = mean_val, median = median_val, sd = sd_val, Q1 = quantiles[1], Q3 = quantiles[2], Min = min, Max = max)
}
summary_table <- t(sapply(dep_vars, function(var) calc_stats(cleaned_data[[var]])))
summary_table <- as.data.frame(summary_table)
kable(summary_table, col.names = c("Variable", "Mean", "Median", "SD", "25th Percentile", "75th Percentile", "Min", "Max"),
caption = "Summary Statistics for Dependent Variables")
#| label: fig-normality
#| echo: false
#| eval: true
#| fig-cap: "Plots used to check if the distribution of the final calf weight is normal."
#| layout-ncol: 2
#| fig-subcap:
#|  - "Histogram of final calf weight."
#|  - "Q-Q plot of final calf weight."
#| fig-width: 6
#| fig-height: 4
bin_width <- round(2*IQR(data$Final.Calf.BW)/(length(data$Final.Calf.BW))^(1/3), 2)
ggplot(data, aes(x = Final.Calf.BW)) +
geom_histogram(binwidth = bin_width, color = "black", fill = "skyblue") +
labs(
x = "Weight",
y = "Frequency"
) +
theme_minimal()
ggplot(data, aes(sample = Final.Calf.BW)) +
stat_qq() +
stat_qq_line(color = "red") +
labs(
x = "Theoretical Quantiles",
y = "Sample Quantiles"
) +
theme_minimal()
#| label: fig-scoring-dist
#| echo: false
#| eval: true
#| fig-cap: "Histograms of scoring variables."
#| layout-ncol: 2
#| fig-subcap:
#|  - "Histogram of calving ease."
#|  - "Histogram of calf vigor."
#| fig-width: 6
#| fig-height: 4
ggplot(data, aes(x = Calving.Ease)) +
geom_histogram(binwidth = 1, color = "black", fill = "skyblue") +
labs(
x = "Ease Score",
y = "Frequency"
) +
theme_minimal()
ggplot(data, aes(x = Calf.Vigor)) +
geom_histogram(binwidth = 1, color = "black", fill = "skyblue") +
labs(
x = "Vigor Score",
y = "Frequency"
) +
theme_minimal()
# Load necessary libraries
library(ggplot2)
library(gridExtra)
# Boxplot for Final Body Weight by Treatment
plot1 <- ggplot(data2, aes(x = Calan.Treatment, y = Final.BW, fill = Calan.Treatment)) +
geom_boxplot(outlier.color = "red", alpha = 0.7) +
labs(title = "Boxplot of Final Body Weight by Treatment", x = "Treatment", y = "Final BW") +
theme_minimal() +
scale_fill_brewer(palette = "Set3")
#| label: fig-exploratory-plots
#| echo: false
#| eval: TRUE
#| layout-ncol: 2
#| layout-nrow: 2
## Toma data set
#data2 <- read.csv("imput_data.csv")
## Ryan data set
data2 <- cleaned_data
# Cross-tabulation: Relationship between treatments and calf sex
crosstab_treatment_sex <- table(data2$Calan.Treatment, data2$SEX)
print(crosstab_treatment_sex)
# Boxplot: Final Body Weight by Treatment and Sex
ggplot(data2, aes(x = Calan.Treatment, y = Final.BW, fill = SEX)) +
geom_boxplot(outlier.color = "red", alpha = 0.7) +
labs(title = "Final Body Weight by Treatment and Sex", x = "Treatment", y = "Final Body Weight") +
theme_minimal()
# Scatterplot: Calf Vigor vs. Final Body Weight
ggplot(data2, aes(x = Calf.Vigor, y = Final.BW, color = SEX, shape = Calan.Treatment)) +
geom_point(size = 3, alpha = 0.7) +
labs(title = "Scatterplot of Calf Vigor vs. Final Body Weight", x = "Calf Vigor", y = "Final Body Weight") +
theme_minimal()
# Scatterplot: Calving Ease vs. Final Body Weight
ggplot(data2, aes(x = Calving.Ease, y = Final.BW, color = SEX, shape = Calan.Treatment)) +
geom_point(size = 3, alpha = 0.7) +
labs(title = "Scatterplot of Calving Ease vs. Final Body Weight", x = "Calving Ease", y = "Final Body Weight") +
theme_minimal()
#| label: fig-box-1
#| echo: false
#| eval: true
#| fig-cap: "Final body weight by treatment and sex."
#| fig-width: 6
#| fig-height: 4
## Toma data set
#data2 <- read.csv("imput_data.csv")
## Ryan data set
data2 <- cleaned_data
ggplot(data2, aes(x = Calan.Treatment, y = Final.BW, fill = SEX)) +
geom_boxplot(outlier.color = "red", alpha = 0.7) +
labs(x = "Treatment", y = "Final Body Weight") +
theme_minimal()
#| label: fig-table
#| echo: false
#| eval: true
#| fig-cap: "Table showing the breakdown of treatment by sex."
## Toma data set
#data2 <- read.csv("imput_data.csv")
## Ryan data set
data2 <- cleaned_data
crosstab_treatment_sex <- table(data2$Calan.Treatment, data2$SEX)
crosstab_df <- as.data.frame(crosstab_treatment_sex)
kable(
crosstab_df,
col.names = c("Treatment", "Sex", "Count"))
#| label: fig-table
#| echo: false
#| eval: true
#| fig-cap: "Table showing the breakdown of treatment by sex."
## Toma data set
#data2 <- read.csv("imput_data.csv")
## Ryan data set
data2 <- cleaned_data
crosstab_treatment_sex <- table(data2$Calan.Treatment, data2$SEX)
crosstab_df <- as.data.frame(crosstab_treatment_sex)
kable(
crosstab_treatment_sex)
